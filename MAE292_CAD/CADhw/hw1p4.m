p1 = [4,6,0];
p2 = [4,6,2];
p3 = [3,14,0];
p4 = [3,14,6];
p5 = [11,5,0];
p6 = [11,5,4];
P = [p1;p2;p3;p4;p5;p6];

scatter3(P(1,:),P(2,:),P(3,:))
P1 = [p1' p2' p3' p4' p5' p6'];
P1(4, :)=1;

hold on
fill3([P(1,1) P(3,1) P(5,1)],[P(1,2) P(3,2) P(5,2)],[P(1,3) P(3,3) P(5,3)],'r');
fill3([P(2,1) P(4,1) P(6,1)],[P(2,2) P(4,2) P(6,2)],[P(2,3) P(4,3) P(6,3)],'y');
fill3([P(1,1) P(2,1) P(4,1) P(3,1)],[P(1,2) P(2,2) P(4,2) P(3,2)],[P(1,3) P(2,3) P(4,3) P(3,3)],'b');
fill3([P(1,1) P(2,1) P(6,1) P(5,1)],[P(1,2) P(2,2) P(6,2) P(5,2)],[P(1,3) P(2,3) P(6,3) P(5,3)],'g');
fill3([P(3,1) P(4,1) P(6,1) P(5,1)],[P(3,2) P(4,2) P(6,2) P(5,2)],[P(3,3) P(4,3) P(6,3) P(5,3)],'k');

%b
%%Reflection yz plan
Reflection = [-1 0 0 0;
              0 1 0 0;
              0 0 1 0;
              0 0 0 1];
PRa = Reflection * P1;
PR = PRa';
scatter3(PR(:,1),PR(:,2),PR(:,3))


hold on
fill3([PR(1,1) PR(3,1) PR(5,1)],[PR(1,2) PR(3,2) PR(5,2)],[PR(1,3) PR(3,3) PR(5,3)],'r');
fill3([PR(2,1) PR(4,1) PR(6,1)],[PR(2,2) PR(4,2) PR(6,2)],[PR(2,3) PR(4,3) PR(6,3)],'y');
fill3([PR(1,1) PR(2,1) PR(4,1) PR(3,1)],[PR(1,2) PR(2,2) PR(4,2) PR(3,2)],[PR(1,3) PR(2,3) PR(4,3) PR(3,3)],'b');
fill3([PR(1,1) PR(2,1) PR(6,1) PR(5,1)],[PR(1,2) PR(2,2) PR(6,2) PR(5,2)],[PR(1,3) PR(2,3) PR(6,3) PR(5,3)],'g');
fill3([PR(3,1) PR(4,1) PR(6,1) PR(5,1)],[PR(3,2) PR(4,2) PR(6,2) PR(5,2)],[PR(3,3) PR(4,3) PR(6,3) PR(5,3)],'k');

%%Scalling
Scalling = [4 0 0 0;
            0 4 0 0;
            0 0 4 0;
            0 0 0 1];
        
P2a = Reflection * Scalling * P1;
P2 = P2a';    

scatter3(P2(:,1),P2(:,2),P2(:,3))


hold on
fill3([P2(1,1) P2(3,1) P2(5,1)],[P2(1,2) P2(3,2) P2(5,2)],[P2(1,3) P2(3,3) P2(5,3)],'r');
fill3([P2(2,1) P2(4,1) P2(6,1)],[P2(2,2) P2(4,2) P2(6,2)],[P2(2,3) P2(4,3) P2(6,3)],'y');
fill3([P2(1,1) P2(2,1) P2(4,1) P2(3,1)],[P2(1,2) P2(2,2) P2(4,2) P2(3,2)],[P2(1,3) P2(2,3) P2(4,3) P2(3,3)],'b');
fill3([P2(1,1) P2(2,1) P2(6,1) P2(5,1)],[P2(1,2) P2(2,2) P2(6,2) P2(5,2)],[P2(1,3) P2(2,3) P2(6,3) P2(5,3)],'g');
fill3([P2(3,1) P2(4,1) P2(6,1) P2(5,1)],[P2(3,2) P2(4,2) P2(6,2) P2(5,2)],[P2(3,3) P2(4,3) P2(6,3) P2(5,3)],'k');

%c
%%Rotation
theta = 120 * pi/180;
phix = 60 * pi/180;
phiy = 60 * pi/180;



n1 = cos(phix);
n2 = cos(phiy);
n3 = (1 - n1^2 -n2^2)^(1/2);


Rotation = [n1^2+(1-n1^2)*cos(theta), n1*n2*(1-cos(theta))+n3*sin(theta), n1*n3*(1-cos(theta))-n2*sin(theta), 0;
     n1*n2*(1-cos(theta))-n3*sin(theta), n2^2+(1-n2^2)*cos(theta), n2*n3*(1-cos(theta))+n1*sin(theta), 0;
     n1*n3*(1-cos(theta))+n2*sin(theta), n2*n3*(1-cos(theta))-n1*sin(theta), n3^2+(1-n3^2)*cos(theta), 0;
     0 0 0 1];   
P3a = Rotation * P1;
P3 = P3a';    
scatter3(P3(:,1),P3(:,2),P3(:,3))


hold on
fill3([P3(1,1) P3(3,1) P3(5,1)],[P3(1,2) P3(3,2) P3(5,2)],[P3(1,3) P3(3,3) P3(5,3)],'r');
fill3([P3(2,1) P3(4,1) P3(6,1)],[P3(2,2) P3(4,2) P3(6,2)],[P3(2,3) P3(4,3) P3(6,3)],'y');
fill3([P3(1,1) P3(2,1) P3(4,1) P3(3,1)],[P3(1,2) P3(2,2) P3(4,2) P3(3,2)],[P3(1,3) P3(2,3) P3(4,3) P3(3,3)],'b');
fill3([P3(1,1) P3(2,1) P3(6,1) P3(5,1)],[P3(1,2) P3(2,2) P3(6,2) P3(5,2)],[P3(1,3) P3(2,3) P3(6,3) P3(5,3)],'g');
fill3([P3(3,1) P3(4,1) P3(6,1) P3(5,1)],[P3(3,2) P3(4,2) P3(6,2) P3(5,2)],[P3(3,3) P3(4,3) P3(6,3) P3(5,3)],'k');
